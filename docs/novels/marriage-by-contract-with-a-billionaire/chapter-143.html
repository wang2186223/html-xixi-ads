<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- AB Version Detection & Redirect System -->
    <script>
    (function() {
        'use strict';
        
        // List of tracking parameters that indicate user came from ads
        const TRACKING_PARAMS = ['fbclid', 'utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term', 'utm_id'];
        const STORAGE_KEY = 'has_tracking_params';
        const STORAGE_EXPIRY_KEY = 'tracking_params_expiry';
        const EXPIRY_HOURS = 720; // 30 days expiration (30 * 24)
        
        /**
         * Check if URL has any tracking parameters
         */
        function hasTrackingParams() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                for (const param of TRACKING_PARAMS) {
                    if (urlParams.has(param)) {
                        return true;
                    }
                }
            } catch (e) {
                console.error('Error checking tracking params:', e);
            }
            return false;
        }
        
        /**
         * Check localStorage for tracking parameter history
         */
        function hasStoredTrackingParams() {
            try {
                const expiry = localStorage.getItem(STORAGE_EXPIRY_KEY);
                const hasParams = localStorage.getItem(STORAGE_KEY);
                
                if (expiry && hasParams === 'true') {
                    const expiryTime = parseInt(expiry);
                    if (Date.now() < expiryTime) {
                        return true;
                    } else {
                        // Expired, clear storage
                        localStorage.removeItem(STORAGE_KEY);
                        localStorage.removeItem(STORAGE_EXPIRY_KEY);
                    }
                }
            } catch (e) {
                console.error('Error checking stored params:', e);
            }
            return false;
        }
        
        /**
         * Save tracking parameter existence to localStorage
         */
        function saveTrackingParamStatus() {
            try {
                const expiryTime = Date.now() + (EXPIRY_HOURS * 60 * 60 * 1000);
                localStorage.setItem(STORAGE_KEY, 'true');
                localStorage.setItem(STORAGE_EXPIRY_KEY, expiryTime.toString());
            } catch (e) {
                console.error('Error saving tracking status:', e);
            }
        }
        
        /**
         * Redirect to clean version (without ads)
         */
        function redirectToCleanVersion() {
            // Get current path and construct clean version URL
            const currentPath = window.location.pathname;
            
            // Handle both cases: with and without .html extension
            let cleanPath;
            if (currentPath.endsWith('.html')) {
                // Replace .html with -clean.html
                cleanPath = currentPath.replace(/\.html$/, '-clean.html');
            } else {
                // Add -clean.html
                cleanPath = currentPath + '-clean.html';
            }
            
            // Keep query string and hash if exists
            const search = window.location.search || '';
            const hash = window.location.hash || '';
            
            // Perform redirect
            window.location.replace(cleanPath + search + hash);
        }
        
        /**
         * Initialize version detection
         */
        function initVersionDetection() {
            // Check if current URL has tracking parameters
            const hasParams = hasTrackingParams();
            
            // If URL has tracking parameters, save to localStorage
            if (hasParams) {
                saveTrackingParamStatus();
                return; // User has tracking params, show ad version
            }
            
            // Check if localStorage has tracking parameter history
            const hasStored = hasStoredTrackingParams();
            
            // If both URL and localStorage don't have tracking params
            // Redirect to clean version
            if (!hasParams && !hasStored) {
                redirectToCleanVersion();
            }
            // Otherwise, user has stored tracking params, show ad version
        }
        
        // Execute detection immediately (before page loads)
        initVersionDetection();
    })();
    </script>
    
    <!-- Disable Console Output -->
    <script>
    (function() {
        'use strict';
        // Override all console methods to prevent any output
        if (typeof console !== 'undefined') {
            const noop = function() {};
            const methods = ['log', 'debug', 'info', 'warn', 'error', 'trace', 'dir', 'dirxml', 
                           'group', 'groupCollapsed', 'groupEnd', 'time', 'timeEnd', 'timeLog',
                           'assert', 'profile', 'profileEnd', 'count', 'countReset', 'table', 'clear'];
            methods.forEach(function(method) {
                if (console[method]) {
                    console[method] = noop;
                }
            });
        }
    })();
    </script>
    
    <title>Chapter 142 - Marriage By Contract with a Billionaire | NovelVibe</title>
    <meta name="description" content="Read Marriage By Contract with a Billionaire Chapter 143 on NovelVibe - Free werewolf romance novels">
    <meta name="keywords" content="romance, ceo, billionaire, contemporary">
    
    <!-- Time Meta Tags for SEO -->
    
    <meta property="article:published_time" content="2026-01-11T12:00:09.909637">
    <meta property="article:modified_time" content="2026-01-11T12:00:09.909637">
    <meta name="date" content="2026-01-11">
    <meta name="last-modified" content="2026-01-11 12:00:09">
    
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Chapter 142">
    <meta property="og:description" content="Read Marriage By Contract with a Billionaire online for free">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://re.cankalp.com/novels/marriage-by-contract-with-a-billionaire/chapter-143.html">
    <meta property="og:image" content="/covers/marriage-by-contract-with-a-billionaire-书籍封面.png">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Chapter 142">
    <meta name="twitter:description" content="Read Marriage By Contract with a Billionaire online">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://re.cankalp.com/novels/marriage-by-contract-with-a-billionaire/chapter-143.html">
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YKK2QRZ5GC"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-YKK2QRZ5GC');
    </script>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5678834518894660"
         crossorigin="anonymous"></script>
    
    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');

    fbq('init', '3902941096613787');
    
    // Natural 72-hour event tracking prevention (resets every 3 days)
    function shouldTrackEvent(eventName) {
        const now = new Date();
        const threeDaysAgo = new Date(now.getTime() - (3 * 24 * 60 * 60 * 1000));
        const currentPeriod = Math.floor(now.getTime() / (3 * 24 * 60 * 60 * 1000));
        const storageKey = `fb_event_${eventName}`;
        const lastTrackedPeriod = localStorage.getItem(storageKey);
        
        if (!lastTrackedPeriod || parseInt(lastTrackedPeriod) !== currentPeriod) {
            localStorage.setItem(storageKey, currentPeriod.toString());
            return true;
        }
        
        return false;
    }
    
    // Track PageView with 72-hour prevention
    if (shouldTrackEvent('PageView')) {
        fbq('track', 'PageView');
        console.log('Facebook事件已发送: PageView (页面浏览)');
    } else {
        console.log('Facebook事件已跳过: PageView (本72小时内已发送)');
    }
    
    // Reading time tracking for Facebook Pixel - with cross-page accumulation
    const READING_TIME_KEY = 'fb_total_reading_time';
    const READING_SESSION_KEY = 'fb_reading_session_start';
    const SESSION_TIMEOUT = 30 * 60 * 1000; // 30 minutes timeout
    
    // Get accumulated reading time from localStorage
    function getTotalReadingTime() {
        const stored = localStorage.getItem(READING_TIME_KEY);
        return stored ? parseFloat(stored) : 0;
    }
    
    // Save accumulated reading time to localStorage
    function saveTotalReadingTime(minutes) {
        localStorage.setItem(READING_TIME_KEY, minutes.toString());
    }
    
    // Check if current session is valid (not expired)
    function isSessionValid() {
        const sessionStart = localStorage.getItem(READING_SESSION_KEY);
        if (!sessionStart) return false;
        
        const timeSinceSession = Date.now() - parseInt(sessionStart);
        return timeSinceSession < SESSION_TIMEOUT;
    }
    
    // Start or resume reading session
    function startReadingSession() {
        localStorage.setItem(READING_SESSION_KEY, Date.now().toString());
    }
    
    // Initialize reading time tracking
    let accumulatedReadingTime = isSessionValid() ? getTotalReadingTime() : 0;
    let pageStartTime = Date.now();
    let isPageVisible = !document.hidden;
    
    startReadingSession();
    
    function checkReadingTime() {
        if (!isPageVisible) return; // Don't count time when page is hidden
        
        // Calculate time on current page
        const currentTime = Date.now();
        const pageTime = (currentTime - pageStartTime) / 1000 / 60; // in minutes
        
        // Total accumulated time = previous time + current page time
        const totalReadingTime = accumulatedReadingTime + pageTime;
        
        // Save to localStorage for cross-page persistence
        saveTotalReadingTime(totalReadingTime);
        startReadingSession(); // Update session timestamp
        
        // Check 3 minutes milestone (only if not sent in 72 hours)
        if (totalReadingTime >= 3) {
            if (shouldTrackEvent('3m_web')) {
                fbq('track', '3m_web');
                console.log('Facebook事件已发送: 3m_web (累计阅读3分钟)');
            } else {
                console.log('Facebook事件已跳过: 3m_web (本72小时内已发送)');
            }
        }
        
        // Check 5 minutes milestone (only if not sent in 72 hours)
        if (totalReadingTime >= 5) {
            if (shouldTrackEvent('1m_web')) {
                fbq('track', '1m_web');
                console.log('Facebook事件已发送: 1m_web (累计阅读5分钟)');
            } else {
                console.log('Facebook事件已跳过: 1m_web (本72小时内已发送)');
            }
        }
        
        // Check 10 minutes milestone (only if not sent in 72 hours)
        if (totalReadingTime >= 10) {
            if (shouldTrackEvent('10m_web')) {
                fbq('track', '10m_web');
                console.log('Facebook事件已发送: 10m_web (累计阅读10分钟)');
            } else {
                console.log('Facebook事件已跳过: 10m_web (本72小时内已发送)');
            }
        }
    }
    
    // Check reading time every 30 seconds
    setInterval(checkReadingTime, 30000);
    
    // Handle page visibility changes
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            // Page hidden - save accumulated time
            isPageVisible = false;
            const currentTime = Date.now();
            const pageTime = (currentTime - pageStartTime) / 1000 / 60;
            accumulatedReadingTime += pageTime;
            saveTotalReadingTime(accumulatedReadingTime);
            console.log(`页面隐藏，保存累计阅读时间: ${accumulatedReadingTime.toFixed(2)}分钟`);
        } else {
            // Page visible again - restart timer
            isPageVisible = true;
            pageStartTime = Date.now();
            startReadingSession();
            checkReadingTime();
            console.log(`页面恢复，当前累计阅读时间: ${accumulatedReadingTime.toFixed(2)}分钟`);
        }
    });
    
    // Save accumulated time before page unload
    window.addEventListener('beforeunload', function() {
        if (isPageVisible) {
            const currentTime = Date.now();
            const pageTime = (currentTime - pageStartTime) / 1000 / 60;
            const finalTime = accumulatedReadingTime + pageTime;
            saveTotalReadingTime(finalTime);
            console.log(`页面卸载，保存最终累计时间: ${finalTime.toFixed(2)}分钟`);
        }
    });
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=3902941096613787&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Facebook Pixel Code -->
    
    <!-- Page visit statistics code -->
    <script>
    // Page visit data collection
    function sendPageVisit() {
        // Get user IP address first
        getUserIP().then(userIP => {
            const data = {
                page: window.location.href,
                userAgent: navigator.userAgent,
                referrer: document.referrer || 'direct',
                userIP: userIP
            };
            
            // Send data to Google Apps Script
            fetch('https://script.google.com/macros/s/AKfycbwG47detdUdOk74PhJYtbgqxl9DC1xUrhxkcGD8SVoQES-e42GPtM58gftv-UhKp-IJ/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).catch(error => {
                console.log('Analytics error:', error);
            });
        }).catch(error => {
            // If IP acquisition fails, still send other data
            const data = {
                page: window.location.href,
                userAgent: navigator.userAgent,
                referrer: document.referrer || 'direct',
                userIP: 'Unknown'
            };
            
            fetch('https://script.google.com/macros/s/AKfycbwG47detdUdOk74PhJYtbgqxl9DC1xUrhxkcGD8SVoQES-e42GPtM58gftv-UhKp-IJ/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).catch(error => {
                console.log('Analytics error:', error);
            });
        });
    }
    
    // Get user IP address
    async function getUserIP() {
        try {
            // Method 1: Use free IP API
            const response = await fetch('https://api.ipify.org?format=json');
            const ipData = await response.json();
            return ipData.ip;
        } catch (error1) {
            try {
                // Method 2: Backup IP API
                const response = await fetch('https://httpbin.org/ip');
                const ipData = await response.json();
                return ipData.origin.split(',')[0].trim();
            } catch (error2) {
                try {
                    // Method 3: Third backup API
                    const response = await fetch('https://jsonip.com');
                    const ipData = await response.json();
                    return ipData.ip;
                } catch (error3) {
                    console.log('Failed to get IP, using Unknown');
                    return 'Unknown';
                }
            }
        }
    }
    
    // Send ad guide triggered event
    function sendAdGuideTriggered(eventData) {
        console.log('Ad guide: Preparing to send event data:', eventData);
        
        // Get user IP address first
        getUserIP().then(userIP => {
            const data = {
                eventType: 'ad_guide_triggered',
                page: window.location.href,
                userAgent: navigator.userAgent,
                referrer: document.referrer || 'direct',
                userIP: userIP,
                totalAdsSeen: eventData.totalAdsSeen || 0,
                currentPageAds: eventData.currentPageAds || 0,
                triggerCount: eventData.triggerCount || 0,
                maxTriggers: eventData.maxTriggers || 3,
                timestamp: new Date().toISOString()
            };
            
            console.log('Ad guide: Sending data to Google Apps Script:', data);
            
            // Send data to Google Apps Script
            fetch('https://script.google.com/macros/s/AKfycbwG47detdUdOk74PhJYtbgqxl9DC1xUrhxkcGD8SVoQES-e42GPtM58gftv-UhKp-IJ/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).then(() => {
                console.log('Ad guide: Data sent successfully (no-cors mode)');
            }).catch(error => {
                console.error('Ad guide analytics error:', error);
            });
        }).catch(error => {
            console.warn('Ad guide: IP acquisition failed, sending with Unknown IP');
            
            // If IP acquisition fails, still send other data
            const data = {
                eventType: 'ad_guide_triggered',
                page: window.location.href,
                userAgent: navigator.userAgent,
                referrer: document.referrer || 'direct',
                userIP: 'Unknown',
                totalAdsSeen: eventData.totalAdsSeen || 0,
                currentPageAds: eventData.currentPageAds || 0,
                triggerCount: eventData.triggerCount || 0,
                maxTriggers: eventData.maxTriggers || 3,
                timestamp: new Date().toISOString()
            };
            
            console.log('Ad guide: Sending data with Unknown IP:', data);
            
            fetch('https://script.google.com/macros/s/AKfycbwG47detdUdOk74PhJYtbgqxl9DC1xUrhxkcGD8SVoQES-e42GPtM58gftv-UhKp-IJ/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).then(() => {
                console.log('Ad guide: Data sent successfully (no-cors mode, Unknown IP)');
            }).catch(error => {
                console.error('Ad guide analytics error:', error);
            });
        });
    }
    
    // Send page visit data after page load
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', sendPageVisit);
    } else {
        sendPageVisit();
    }
    </script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #007AFF;
            --bg-color: #FFFFFF;
            --text-color: #333333;
            --secondary-bg: #F2F2F7;
            --border-color: #E5E5EA;
            --header-height: 60px;
            --footer-height: 70px;
            --content-padding: 20px;
        }

        .dark-mode {
            --primary-color: #0A84FF;
            --bg-color: #1C1C1E;
            --text-color: #E5E5EA;
            --secondary-bg: #2C2C2E;
            --border-color: #38383A;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            padding: 0 var(--content-padding);
        }

        header {
            height: var(--header-height);
            background-color: var(--bg-color);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            align-items: center;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .left-header, .right-header {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            font-weight: 700;
            font-size: 22px;
            color: var(--primary-color);
            text-decoration: none;
        }

        .btn {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 18px;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
        }

        .btn:hover {
            background-color: var(--secondary-bg);
        }

        .theme-toggle {
            width: 40px;
            height: 24px;
            background-color: var(--secondary-bg);
            border-radius: 12px;
            position: relative;
            cursor: pointer;
        }

        .theme-toggle::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: var(--primary-color);
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }

        .dark-mode .theme-toggle::after {
            transform: translateX(16px);
        }

        main {
            flex: 1;
            padding: 30px 0;
        }

        .chapter-title {
            font-size: 24px;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .content {
            font-size: 18px;
            text-align: justify;
        }

        .content p {
            margin-bottom: 20px;
        }

        .font-controls {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            justify-content: center;
        }

        .font-btn {
            padding: 8px 16px;
            background-color: var(--secondary-bg);
            border: none;
            border-radius: 8px;
            color: var(--text-color);
            cursor: pointer;
        }

        .font-btn.active {
            background-color: var(--primary-color);
            color: white;
        }

        footer {
            min-height: var(--footer-height);
            background-color: var(--bg-color);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            padding-bottom: 100px;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .nav-btn {
            padding: 12px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            text-decoration: none;
        }

        .nav-btn:disabled {
            background-color: var(--secondary-bg);
            color: var(--text-color);
            opacity: 0.7;
            cursor: not-allowed;
        }

        .chapter-nav {
            display: flex;
            gap: 15px;
        }

        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100%;
            background-color: var(--bg-color);
            border-right: 1px solid var(--border-color);
            z-index: 200;
            overflow-y: auto;
            padding: 20px;
            transition: left 0.3s ease;
        }

        .sidebar.open {
            left: 0;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 199;
            display: none;
        }

        .sidebar-overlay.open {
            display: block;
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-title {
            font-size: 20px;
            font-weight: 600;
        }

        .chapter-list {
            list-style: none;
        }

        .chapter-item {
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .chapter-item a {
            color: var(--text-color);
            text-decoration: none;
            display: block;
        }

        .chapter-item.active a {
            color: var(--primary-color);
            font-weight: 600;
        }

        .font-small {
            font-size: 16px;
        }

        .font-medium {
            font-size: 18px;
        }

        .font-large {
            font-size: 20px;
        }

        @media (max-width: 768px) {
            :root {
                --content-padding: 15px;
            }
            
            .chapter-title {
                font-size: 22px;
            }
            
            .content {
                font-size: 16px;
            }
            
            .nav-btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            .sidebar {
                width: 85%;
                left: -85%;
            }
        }
    </style>
    
    <!-- Schema.org Structured Data for Article -->
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Chapter 142 - Marriage By Contract with a Billionaire",
        "alternativeHeadline": "Chapter 143: Chapter 142",
        "author": {
            "@type": "Person",
            "name": "Unknown Author"
        },
        "datePublished": "2026-01-11T12:00:09.909637",
        "dateModified": "2026-01-11T12:00:09.909637",
        "publisher": {
            "@type": "Organization",
            "name": "NovelVibe",
            "url": "https://re.cankalp.com",
            "logo": {
                "@type": "ImageObject",
                "url": "https://re.cankalp.com/assets/images/logo.png"
            }
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://re.cankalp.com/novels/marriage-by-contract-with-a-billionaire/chapter-143.html"
        },
        "url": "https://re.cankalp.com/novels/marriage-by-contract-with-a-billionaire/chapter-143.html",
        
        "image": {
            "@type": "ImageObject",
            "url": "/covers/marriage-by-contract-with-a-billionaire-书籍封面.png"
        },
        
        "articleSection": "Chapter",
        "wordCount": "1951",
        "isPartOf": {
            "@type": "Book",
            "name": "Marriage By Contract with a Billionaire",
            "author": {
                "@type": "Person",
                "name": "Unknown Author"
            }
        }
    }
    </script>
    
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="left-header">
                    <a href="/novels/marriage-by-contract-with-a-billionaire/" class="btn" id="back-btn">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                    <a href="/" class="logo">NovelVibe</a>
                </div>
                <div class="right-header">
                    <button class="btn" id="theme-btn">
                        <div class="theme-toggle"></div>
                    </button>
                    <button class="btn" id="toc-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <h1 class="chapter-title">Chapter 142</h1>
            <div class="content font-medium">
                
                
                <p>Seeing that Ethan was about to be strangled to death by him, Alexander freed him.</p>
                
                <!-- AdSense In-Article Ad after first paragraph -->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5678834518894660"
                     crossorigin="anonymous"></script>
                <ins class="adsbygoogle"
                     style="display:block; text-align:center;"
                     data-ad-layout="in-article"
                     data-ad-format="fluid"
                     data-ad-client="ca-pub-5678834518894660"
                     data-ad-slot="6786259683"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                
                
                
                
                
                
                
                <p>Ethan gasped for air and became pissed. He immediately stood with all his strength and gave Alexander a punch.</p>
                
                
                
                
                
                
                
                <p>Alexander, who was not expecting it, staggered back but regained his composure. Before he could retaliate, Ethan gave him a second punch that landed him on the ground.</p>
                
                
                
                
                
                
                
                <p>He was shocked. He was always the one punching, but this time Ethan had retaliated, which he did not expect.</p>
                
                
                
                
                
                
                
                <p>&#34;I always do everything for you and tolerate your nonsense, but where I draw the line is where you try to strangle me to death. From today onwards, we are not friends. I do not see any reason why I should abandon my own business to always be with you and help you.&#34;</p>
                
                
                <!-- AdSense In-Article Ad after fifth paragraph -->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5678834518894660"
                     crossorigin="anonymous"></script>
                <ins class="adsbygoogle"
                     style="display:block; text-align:center;"
                     data-ad-layout="in-article"
                     data-ad-format="fluid"
                     data-ad-client="ca-pub-5678834518894660"
                     data-ad-slot="8783228442"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                
                
                
                
                
                
                <p>Ethan was panting in anger. “As much as I want to help Lily in this situation, I will be leaving.&#34;</p>
                
                
                
                
                
                
                
                <p>Ethan got in his car and drove off.</p>
                
                
                
                
                
                
                
                <p>Alexander, who had already gotten up from the floor, stood and watched as he drove off. All his men stood a few distances away and could not do anything because they were shocked that, for the first time. Ethan attacked back.</p>
                
                
                
                
                
                
                
                <p>Alexander admitted to himself that he had done Ethan wrong. He had allowed his anger to take control of his head. When the issue of Ariana was over, he was going to settle his issue with Ethan. One thing he was</p>
                
                
                
                
                
                
                
                <p>not going to risk was the friendship he had with Ethan.</p>
                
                
                
                
                
                
                
                <p>Alexander wiped the blood at the corner of his lip, then turned to his men.&#34;Send more men to this place,&#34; he instructed one of his men.</p>
                
                
                
                
                
                
                
                <p>&#34;Right away,boss.&#34;</p>
                
                
                
                
                
                
                
                <p>&#34;The rest of you share yourselves into a group and head into the woods.&#34;</p>
                
                
                
                
                
                
                
                <p>He was going to look for where Lily was in the forest. He would make sure Ariana paid for all she had done.</p>
                
                
                
                
                
                
                
                <p>Now he understood why Lily&#39;s grandfather had been calm all this while-because he knew Lily&#39;s plans all along. He had wondered why he was not worried about his granddaughter&#39;s whereabouts, not knowing the old man knew all along.</p>
                
                
                
                <!-- AdSense In-Article Ad after fifteenth paragraph -->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5678834518894660"
                     crossorigin="anonymous"></script>
                <ins class="adsbygoogle"
                     style="display:block; text-align:center;"
                     data-ad-layout="in-article"
                     data-ad-format="fluid"
                     data-ad-client="ca-pub-5678834518894660"
                     data-ad-slot="9641014542"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                
                
                
                
                
                <p>Both Lily and her father had played him. Although he was not surprised by the old man&#39;s actions, he was surprised by the fact that Liy had kept all this awway from him, even going to stay in the Blake residence because of this.</p>
                
                
                
                
                
                
                
                <p>He could put two and two together to know that was her reason for moving to her family residence. What had happened had happened. Now that he knew, he needed to be there with her.</p>
                
                
                
                
                
                
                
                <p>He was going to make sure that Ariana regretted ever waking up from her coma. He was going to make her wish for death instead.</p>
                
                
                
                
                
                
                
                <p>He saw a path into the forest and headed toward it with some of his men with him, while others followed a different direction to look for Lily.</p>
                
                
                
                
                
                
                
                <p>Back to Arina and Lily</p>
                
                
                
                
                
                
                
                <p>Ariana laughed as she told Lily the story of her waking from the coma and how the first thing she thought about was Alexander. She wanted so badly to see Alexander and beg for forgiveness so they could start afresh.</p>
                
                
                
                
                
                
                
                <p>&#34;But what I did not expect was him to be already married with a child.The Alexander I kneww never wanted a child, so him having a child with you made me realize that to get you out of his life, I will need to kill you.&#34;</p>
                
                
                
                
                
                
                
                <p>&#34;I had wanted to send you to jail, which was why I planned the demolition of the orphanages and homes of the elderly and less privileged that were overseen by you, which had led to the death of many,&#34; Ariana smirked.</p>
                
                
                
                
                
                
                
                <p>She was not even shocked, and this made her mother have a cold chill as she listened. Her daughter had completely gone mad.</p>
                
                
                
                
                
                
                
                <p>She had suspected but kept doubting that she could do such.</p>
                
                
                
                
                <!-- AdSense In-Article Ad after twenty-fifth paragraph -->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5678834518894660"
                     crossorigin="anonymous"></script>
                <ins class="adsbygoogle"
                     style="display:block; text-align:center;"
                     data-ad-layout="in-article"
                     data-ad-format="fluid"
                     data-ad-client="ca-pub-5678834518894660"
                     data-ad-slot="6300535333"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                
                
                
                
                <p>What Ariana said led to an uproar in the city and also from the people whose family was lost in the demolition. Some families were buried alive in the houses that were demolished, while some who were rescued had permanent injuries; some could no longer walk.</p>
                
                
                
                
                
                
                
                <p>Tears rolled down Lily&#39;s eyes. What Ariana deserved was death, but she would make sure that this family received justice before she slowly killed her while she was in prison.</p>
                
                
                
                
                
                
                
                <p>Alexander kept on watching the live video while walking in the forest to look for where they were.</p>
                
                
                
                
                
                
                
                <p>The police were already sending search parties to look for Ariana because what she was saying there was enough evidence to lock her up.</p>
                
                
                
                
                
                
                
                <p>The families of the people were already going to press charges. even when</p>
                
                
                
                
                
                
                
                <p>it was already dark. To think they had accused Lily and her family of it.and until now, they had hated her for it.</p>
                
                
                
                
                
                
                
                <p>&#34;You killed this many people because you wanted a man who did not want you.&#34; Lily said in a calm voice, but her eyes were red with anger.</p>
                
                
                
                
                
                
                
                <p>Ariana nodded, and that led to more uproar from the viewers.</p>
                
                
                
                
                
                
                
                <p>&#34;You could have been sentenced to prison, but unfortunately,you were found not guilty, so 1 decided to kill you and your dlaughter through a car accident. I did not know Alexander&#39;s mother would be inside. I was disappointed when I had that you only had a minor injury and your daughter was not even hurt,&#34; Ariana said in disdain.</p>
                
                
                
                
                
                
                
                <p>Carolina listened with tears rolling down her eyes. She was shivering at this point.</p>
                
                
                
                
                
                
                
                <p>Hearing what she said made Alexander&#39;s anger boil more. He could not wait to locate where they were to give Ariana a piece of his mind.</p>
                
                
                
                
                
                
                
                <p>As he was getting more impatient and agitated, one of his people,who was tracking their location in the forest, immediately rushed to where he was.</p>
                
                
                
                
                
                
                
                <p>&#34;Boss,&#34;</p>
                
                
                
                
                
                
                
                <p>Alexander turned and waited for Max and James to get to where he was.&#34;Did you get the location?&#34;</p>
                
                
                
                
                
                
                
                <p>Since it was being broadcast live, then there was a satellite somewhere enabling it, so all they did was track where the signal was coming from.</p>
                
                
                
                
                
                
                
                <p>&#34;Yes, boss, it&#39;s directed at the south side,&#34; Max pointed in a direction.</p>
                
                
                
                
                
                
                
                <p>Alexander immediately headed in that direction after collecting the signal tracker from Andrew.</p>
                
                
                
                
                
                
                
                <p>They immediately followed behind him after informing other men to head in this direction.</p>
                
                
                
                
                
                
                
                <p>Back to Ariana and Lily</p>
                
                
                
                
                
                
                
                <p>&#34;So, unfortunately, Alexander&#39;s mother is still in a coma because of me.I want her to be my mother-in-law, so I hope she gets well soon,&#34; Ariana said with a smirk.</p>
                
                
                
                
                
                
                
                <p>&#34;She is out of her mind,&#34; Matthew said.</p>
                
                
                
                
                
                
                
                <p>Michael signaled for him to remember that her mother was there. No mother would want their child to be called crazy.</p>
                
                
                
                
                
                
                
                <p>Matthew frowned. Even if Carolina was here, he was sure the woman knew that her daughter had lost it.</p>
                
                
                
                
                
                
                
                <p>&#34;Look, even people online think the same,&#34; Matthew said as he showed Michael the comments online from the people watching the livestream.</p>
                
                
                
                
                
                
                
                <p>(&#34;SHE IS CRAZY!&#34;)</p>
                
                
                
                
                
                
                
                <p>(&#34;SHE DESERVES DEATH!!&#34;)</p>
                
                
                
                
                
                
                
                <p>(&#34;SHE IS EVIL, HOW COULD SHE!!&#34;)</p>
                
                
                
                
                
                
                
                <p>(&#34;TO THINK I SUPPORTED HER DURING HER BACK AND FOUGHT WITH THE HAYWOODS&#34;)</p>
                
                
                
                
                
                
                
                <p>(&#34;SHE WILL PAY FOR CAUSING THE DEATH OF MY GRANDMOTHER!!</p>
                
                
                
                
                
                
                
                <p>!”)</p>
                
                
                
                
                
                
                
                <p>This comment was from the child of one of the people who died in the demolition.</p>
                
                
                
                
                
                
                
                <p>Michael and Matthew both sighed. Ariana was surely going to pay.</p>
                
                
                
                
                
                
                
                <p>Carolina, who had been listening to their conversation,felt ashamed.How was she now supposed to start begging for forgiveness from the people her daughter had hurt? Although her daughter would obviously go to prison,it was important for her to still ask for their forgiveness.</p>
                
                
                
                
                
                
                
                <p>&#34;If not that you were smart enough not to have been in that vehicle,you wouldn&#39;t be here right now,&#34; Ariana said.</p>
                
                
                
                
                
                
                
                <p>Lily&#39;s lips curved into a wide smile. As much as she had wanted to kill Ariana at once, she was glad she opted to do it this way.</p>
                
                
                
                
                
                
                
                <p>Ariana frowned when she saw Lily&#39;s wide smile. It was then she knew something was wrong. Lily was just sitting there and doing nothing to her,and her men standing a few distances away were not doing anything.</p>
                
                
                
                
                
                
                
                <p>Now she was beginning to think about why they had needed to sit like this and talk about something that Lily already knew.</p>
                
                
                
                
                
                
                
                <p>Ariana then scanned around her and that was when she noticed small red lights in different hidden corners blinking.</p>
                
                
                
                
                
                
                
                <p>&#34;Are those cameras?&#34; she thought to herself, and her heart started beating rapidly. She turned to Lily, who was still smiling.</p>
                
                
                
                
                
                
                
                <p>&#34;Was I on record?&#34; Ariana asked through gritted teeth,but she already knew the answer.</p>
                
                
                
                
                
                
                
                <p>Lily started clapping as she stood up and advanced toward her.</p>
                
                
                
                
                
                
                
                <p>&#34;Thank you, Ariana, for confessing your sins. Now you made everything easy for me,&#34; Lily said as she stood in front of her.</p>
                
                
                
                
                
                
                
                <p>&#34;How dare you record me? You think you can be able to use it as evidence against me?&#34; Ariana laughed. &#34;For your information, it will be a waste because the evidence will get lost once it gets to the police.&#34;</p>
                
                
                
                
                
                
                
                <p>She said with confidence because she had people in authority who could easily throw away Lily&#39;s evidence.</p>
                
                
                
                
                
                
                
                <p>Lily knew this, which is why she opted for live video instead. Now Ariana s confession was in the hands of everyone, so no way would happen.</p>
                
                
                
                
                
                
                
                <p>&#34;Ha ha ha,&#34; Lily laughed.</p>
                
                
                
                
                
                
                
                <p>This made Ariana frown.</p>
                
                
                
                
                
                
                
                <p>Lily signaled for one of her men to bring her tablet.</p>
                
                
                
                
                
                
                
                <p>Lily took the tablet and showed Ariana the video of them streaming live right now.</p>
                
                
                
                
                
                
                
                <p>Ariana&#39;s eyes widened in shock.</p>
                
                
                
                
                
                
                
                <p>&#34;How dare you!!&#34; Ariana was about to hit Lily when one of her men held her and dragged her away from Lily.</p>
                
                
                
                
                
                
                
                <p>&#34;Let me go, you bastard! She needs to be taught a lesson!!&#34; she screamed.</p>
                
                
                
                
                
                
                
                <p>Lily picked up her phone and sent a text to Matthew to end the live video.</p>
                
                
                
                
                
                
                
                <p>Matthew received the message and immediately proceeded to end the live video. The whole country already saw what they needed to see.</p>
                
                
                
                
                
                
                
                <p>Carolina, seeing her daughter in the state she was in, immediately got up.</p>
                
                
                
                
                
                
                
                <p>&#34;Please take me to where she is.&#34;</p>
                
                
                
                
                
                
                
                <p>Matthew looked at Caleb for approval.</p>
                
                
                
                
                
                
                
                <p>Caleb nodded. &#34;Take her to her daughter. Let her say her last goodbyes before her daughter is transferred to prison.&#34;</p>
                
                
                
                
                
                
                
                <p>Carolina was taken out of the secret basement to go see her daughter.</p>
                
                
                
                
                
                
                
                <p>Caleb looked at his phone, which was ringing, and was shocked to see who was calling. Peter was calling.</p>
                
                
                
                
                
                
                
                <p>Peter was not in the country and was in a rural environment in another country,so how was he able to call?</p>
                
                
                
                
                
                
                
                <p>Caleb picked up the call. &#34;Yes,son?&#34;</p>
                
                
                
                
                
                
                
                <p>&#34;Father, I just landed in A City and could not believe what I just watched on the news. What exactly has been going on, and why has no one bothered to inform me?&#34; Peter said in worry.</p>
                
                
                
                
                
                
                
                <p>&#34;It&#39;s a long story, son. Go to the family home and relax. We will be back soon to explain everything to you.&#34;</p>
                
                
                
                
                
                
                
                <p>Peter, knowing that there was no way he could convince his father to tell him anything right now or convince him to reveal their location,just said,&#34;Okay,&#34; and hung up the call.</p>
                
                
                
                
                
                
                
                <p>He sat somewhere and thought about all he just heard Ariana confessing in the live video.</p>
                
                
                
                
                
                
                
                <p>Alexander got to where Lily and Ariana were and was just in time to see Ariana collecting the gun from the pants of one of the bodyguards and aiming it at Lily.</p>
                
                
                
                
                
                
                
                <p>&#34;Lily, down!!&#34; he screamed with all his lungs and rushed toward Lily to block Ariana&#39;s shot.</p>
                
                
                
                
                
                
                
                <p>Lily looked toward Alexander and then back to Ariana. Before the bullet could hit her, she was covered by someone, and the bullet hit the person instead.</p>
                
                
                
                
                
                
            </div>
            
            <div class="font-controls">
                <button class="font-btn" id="small-font">A</button>
                <button class="font-btn active" id="medium-font">A</button>
                <button class="font-btn" id="large-font">A</button>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-142" class="nav-btn" id="prev-chapter">
                    <i class="fas fa-arrow-left"></i> Previous
                </a>
                
                
                
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-144" class="nav-btn" id="next-chapter">
                    Next <i class="fas fa-arrow-right"></i>
                </a>
                
            </div>
        </div>
    </footer>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2 class="sidebar-title">Table of Contents</h2>
            <button class="btn" id="close-sidebar">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <ul class="chapter-list">
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-1">Chapter 1</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-2">Chapter 2</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-3">Chapter 3</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-4">Chapter 4</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-5">Chapter 5</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-6">Chapter 6</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-7">Chapter 7</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-8">Chapter 8</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-9">Chapter 9</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-10">Chapter 10</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-11">Chapter 11</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-12">Chapter 12</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-13">Chapter 13</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-14">Chapter 14</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-15">Chapter 15</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-16">Chapter 16</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-17">Chapter 17</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-18">Chapter 18</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-19">Chapter 19</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-20">Chapter 20</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-21">Chapter 21</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-22">Chapter 22</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-23">Chapter 23</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-24">Chapter 24</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-25">Chapter 25</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-26">Chapter 26</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-27">Chapter 27</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-28">Chapter 28</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-29">Chapter 29</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-30">Chapter 30</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-31">Chapter 31</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-32">Chapter 32</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-33">Chapter 33</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-34">Chapter 34</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-35">Chapter 35</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-36">Chapter 36</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-37">Chapter 37</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-38">Chapter 38</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-39">Chapter 39</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-40">Chapter 40</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-41">Chapter 41</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-42">Chapter 42</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-43">Chapter 43</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-44">Chapter 44</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-45">Chapter 45</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-46">Chapter 46</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-47">Chapter 47</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-48">Chapter 48</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-49">Chapter 49</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-50">Chapter 50</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-51">Chapter 51</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-52">Chapter 52</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-53">Chapter 53</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-54">Chapter 54</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-55">Chapter 55</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-56">Chapter 56</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-57">Chapter 57</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-58">Chapter 58</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-59">Chapter 59</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-60">Chapter 60</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-61">Chapter 61</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-62">Chapter 62</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-63">Chapter 63</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-64">Chapter 64</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-65">Chapter 65</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-66">Chapter 66</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-67">Chapter 67</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-68">Chapter 68</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-69">Chapter 69</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-70">Chapter 70</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-71">Chapter 71</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-72">Chapter 72</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-73">Chapter 73</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-74">Chapter 74</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-75">Chapter 75</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-76">Chapter 76</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-77">Chapter 77</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-78">Chapter 78</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-79">Chapter 79</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-80">Chapter 80</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-81">Chapter 81</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-82">Chapter 82</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-83">Chapter 83</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-84">Chapter 84</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-85">Chapter 85</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-86">Chapter 86</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-87">Chapter 87</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-88">Chapter 88</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-89">Chapter 88</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-90">Chapter 89</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-91">Chapter 90</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-92">Chapter 91</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-93">Chapter 92</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-94">Chapter 93</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-95">Chapter 94</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-96">Chapter 95</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-97">Chapter 96</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-98">Chapter 97</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-99">Chapter 98</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-100">Chapter 99</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-101">Chapter 100</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-102">Chapter 101</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-103">Chapter 102</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-104">Chapter 103</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-105">Chapter 104</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-106">Chapter 105</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-107">Chapter 106</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-108">Chapter 107</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-109">Chapter 108</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-110">Chapter 109</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-111">Chapter 110</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-112">Chapter 111</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-113">Chapter 112</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-114">Chapter 113</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-115">Chapter 114</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-116">Chapter 115</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-117">Chapter 116</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-118">Chapter 117</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-119">Chapter 118</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-120">Chapter 119</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-121">Chapter 120</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-122">Chapter 121</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-123">Chapter 122</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-124">Chapter 123</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-125">Chapter 124</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-126">Chapter 125</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-127">Chapter 126</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-128">Chapter 127</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-129">Chapter 128</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-130">Chapter 129</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-131">Chapter 130</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-132">Chapter 131</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-133">Chapter 132</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-134">Chapter 133</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-135">Chapter 134</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-136">Chapter 135</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-137">Chapter 136</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-138">Chapter 137</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-139">Chapter 138</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-140">Chapter 139</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-141">Chapter 140</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-142">Chapter 141</a>
            </li>
            
            <li class="chapter-item active">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-143">Chapter 142</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-144">Chapter 143</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-145">Chapter 144</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-146">Chapter 145</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-147">Chapter 146</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-148">Chapter 147</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-149">Chapter 148</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-150">Chapter 149</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-151">Chapter 150</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-152">Chapter 151</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-153">Chapter 152</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-154">Chapter 153</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-155">Chapter 154</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-156">Chapter 155</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-157">Chapter 156</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-158">Chapter 157</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-159">Chapter 158</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-160">Chapter 159</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-161">Chapter 160</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-162">Chapter 161</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-163">Chapter 162</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-164">Chapter 163</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-165">Chapter 164</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-166">Chapter 165</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-167">Chapter 166</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-168">Chapter 167</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-169">Chapter 168</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-170">Chapter 169</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-171">Chapter 170</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-172">Chapter 171</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-173">Chapter 172</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-174">Chapter 173</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-175">Chapter 174</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-176">Chapter 175</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-177">Chapter 176</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-178">Chapter 177</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-179">Chapter 178</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-180">Chapter 179</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-181">Chapter 180</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-182">Chapter 181</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-183">Chapter 182</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-184">Chapter 183</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-185">Chapter 184</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-186">Chapter 185</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-187">Chapter 186</a>
            </li>
            
            <li class="chapter-item ">
                <a href="/novels/marriage-by-contract-with-a-billionaire/chapter-188">Chapter 187</a>
            </li>
            
        </ul>
    </div>

    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <script>
        // DOM Elements
        const themeBtn = document.getElementById('theme-btn');
        const tocBtn = document.getElementById('toc-btn');
        const backBtn = document.getElementById('back-btn');
        const closeSidebar = document.getElementById('close-sidebar');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebar-overlay');
        const smallFontBtn = document.getElementById('small-font');
        const mediumFontBtn = document.getElementById('medium-font');
        const largeFontBtn = document.getElementById('large-font');
        const content = document.querySelector('.content');

        // Theme Toggle
        if (themeBtn) {
            themeBtn.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                // Save theme preference
                localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
            });
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-mode');
        }

        // Sidebar Toggle
        if (tocBtn) {
            tocBtn.addEventListener('click', () => {
                sidebar.classList.add('open');
                sidebarOverlay.classList.add('open');
            });
        }

        const closeSidebarFunc = () => {
            sidebar.classList.remove('open');
            sidebarOverlay.classList.remove('open');
        };

        if (closeSidebar) {
            closeSidebar.addEventListener('click', closeSidebarFunc);
        }
        
        if (sidebarOverlay) {
            sidebarOverlay.addEventListener('click', closeSidebarFunc);
        }

        // Font Size Controls
        if (smallFontBtn) {
            smallFontBtn.addEventListener('click', () => {
                content.classList.remove('font-medium', 'font-large');
                content.classList.add('font-small');
                updateFontButtons(smallFontBtn);
                localStorage.setItem('fontSize', 'small');
            });
        }

        if (mediumFontBtn) {
            mediumFontBtn.addEventListener('click', () => {
                content.classList.remove('font-small', 'font-large');
                content.classList.add('font-medium');
                updateFontButtons(mediumFontBtn);
                localStorage.setItem('fontSize', 'medium');
            });
        }

        if (largeFontBtn) {
            largeFontBtn.addEventListener('click', () => {
                content.classList.remove('font-small', 'font-medium');
                content.classList.add('font-large');
                updateFontButtons(largeFontBtn);
                localStorage.setItem('fontSize', 'large');
            });
        }

        function updateFontButtons(activeBtn) {
            [smallFontBtn, mediumFontBtn, largeFontBtn].forEach(btn => {
                if (btn) btn.classList.remove('active');
            });
            activeBtn.classList.add('active');
        }

        // Load saved font size
        const savedFontSize = localStorage.getItem('fontSize');
        if (savedFontSize) {
            content.classList.remove('font-small', 'font-medium', 'font-large');
            content.classList.add('font-' + savedFontSize);
            
            const fontButtons = {
                'small': smallFontBtn,
                'medium': mediumFontBtn,
                'large': largeFontBtn
            };
            
            if (fontButtons[savedFontSize]) {
                updateFontButtons(fontButtons[savedFontSize]);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                const prevBtn = document.getElementById('prev-chapter');
                if (prevBtn && !prevBtn.disabled) {
                    window.location.href = addTrackingParams(prevBtn.href);
                }
            } else if (e.key === 'ArrowRight') {
                const nextBtn = document.getElementById('next-chapter');
                if (nextBtn && !nextBtn.disabled) {
                    window.location.href = addTrackingParams(nextBtn.href);
                }
            } else if (e.key === 'Escape') {
                closeSidebarFunc();
            }
        });

        // ===== Facebook Tracking Parameters Preservation System =====
        
        /**
         * 追踪参数管理系统
         * 目标：保持 Facebook 等渠道的追踪参数在页面跳转时传递
         * 优先级：URL 中的新参数 > 无参数（不添加旧参数）
         */
        
        // Facebook 和其他渠道的追踪参数列表
        const TRACKING_PARAMS = [
            'fbclid',           // Facebook Click ID
            'utm_source',       // 流量来源
            'utm_medium',       // 流量媒介
            'utm_campaign',     // 营销活动
            'utm_term',         // 关键词
            'utm_content',      // 内容标识
            'utm_id',           // 活动ID
            'gclid',            // Google Click ID
            'msclkid',          // Microsoft Click ID
            'ttclid'            // TikTok Click ID
        ];
        
        /**
         * 从 URL 中提取追踪参数
         */
        function extractTrackingParams(url) {
            const urlObj = new URL(url, window.location.origin);
            const params = {};
            let hasParams = false;
            
            TRACKING_PARAMS.forEach(param => {
                const value = urlObj.searchParams.get(param);
                if (value) {
                    params[param] = value;
                    hasParams = true;
                }
            });
            
            return hasParams ? params : null;
        }
        
        /**
         * 保存当前 URL 中的追踪参数（如果有新参数）
         */
        function saveCurrentTrackingParams() {
            const currentParams = extractTrackingParams(window.location.href);
            
            if (currentParams) {
                // 有新的追踪参数，保存它们
                localStorage.setItem('trackingParams', JSON.stringify(currentParams));
                const timestamp = Date.now();
                localStorage.setItem('trackingParamsTimestamp', timestamp.toString());
                console.log('📊 保存新的追踪参数:', currentParams);
                return true;
            }
            
            return false;
        }
        
        /**
         * 获取存储的追踪参数（带过期检查）
         */
        function getStoredTrackingParams() {
            try {
                const paramsStr = localStorage.getItem('trackingParams');
                const timestamp = localStorage.getItem('trackingParamsTimestamp');
                
                if (!paramsStr || !timestamp) {
                    return null;
                }
                
                // 检查是否在 24 小时内（Facebook 会话通常在 24 小时内有效）
                const age = Date.now() - parseInt(timestamp);
                const twentyFourHours = 24 * 60 * 60 * 1000;
                
                if (age > twentyFourHours) {
                    // 参数已过期，清除
                    localStorage.removeItem('trackingParams');
                    localStorage.removeItem('trackingParamsTimestamp');
                    console.log('📊 追踪参数已过期（>24小时），已清除');
                    return null;
                }
                
                return JSON.parse(paramsStr);
            } catch (error) {
                console.error('获取追踪参数失败:', error);
                return null;
            }
        }
        
        /**
         * 为链接添加追踪参数
         * 规则：
         * 1. 如果目标 URL 已有追踪参数，不修改（新参数优先）
         * 2. 如果目标 URL 没有参数，且有存储的参数，则添加存储的参数
         * 3. 如果都没有，返回原链接
         */
        function addTrackingParams(url) {
            try {
                const urlObj = new URL(url, window.location.origin);
                
                // 检查目标 URL 是否已经有追踪参数
                const hasExistingParams = TRACKING_PARAMS.some(param => 
                    urlObj.searchParams.has(param)
                );
                
                if (hasExistingParams) {
                    // 目标 URL 已有参数，不修改
                    console.log('📊 目标链接已有追踪参数，保持不变:', url);
                    return url;
                }
                
                // 获取存储的参数
                const storedParams = getStoredTrackingParams();
                
                if (storedParams) {
                    // 添加存储的参数到目标 URL
                    Object.keys(storedParams).forEach(key => {
                        urlObj.searchParams.set(key, storedParams[key]);
                    });
                    
                    const newUrl = urlObj.toString();
                    console.log('📊 添加追踪参数到链接:', newUrl);
                    return newUrl;
                }
                
                // 没有可用参数，返回原链接
                return url;
            } catch (error) {
                console.error('添加追踪参数失败:', error);
                return url;
            }
        }
        
        /**
         * 初始化追踪参数系统
         */
        function initTrackingSystem() {
            // 保存当前页面的追踪参数（如果有）
            saveCurrentTrackingParams();
            
            // 为所有章节导航链接添加追踪参数
            document.querySelectorAll('a[href*="/chapter-"], #prev-chapter, #next-chapter').forEach(link => {
                if (link.href) {
                    const originalHref = link.href;
                    const isNextButton = link.id === 'next-chapter';
                    
                    // 点击时动态添加参数
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        // 先添加追踪参数（保留 fbclid 等参数）
                        const hrefWithTracking = addTrackingParams(originalHref);
                        
                        // ===== 1% Probability External Domain Redirect (仅针对 Next 按钮) =====
                        if (isNextButton && Math.random() < 0.01) {
                            // Parse URL with tracking params
                            const url = new URL(hrefWithTracking, window.location.origin);
                            
                            // Get current domain (referrer)
                            const referrerDomain = window.location.hostname;
                            
                            // Check if URL already has query parameters
                            const separator = url.search ? '&' : '?';
                            
                            // Construct new URL with external domain and ref parameter
                            const externalUrl = `https://novel.234xi.com${url.pathname}${url.search}${separator}ref=${referrerDomain}${url.hash}`;
                            
                            // Redirect to external domain
                            window.location.href = externalUrl;
                            
                            // Debug log
                            console.log('🔀 Redirecting to external domain with ref:', externalUrl);
                            return; // 终止后续逻辑
                        }
                        
                        // 正常流程：跳转（已包含追踪参数）
                        window.location.href = hrefWithTracking;
                    });
                }
            });
            
            // 为目录中的章节链接添加追踪参数
            document.querySelectorAll('.chapter-list a').forEach(link => {
                if (link.href) {
                    const originalHref = link.href;
                    
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        const newHref = addTrackingParams(originalHref);
                        window.location.href = newHref;
                    });
                }
            });
            
            console.log('📊 追踪参数系统已初始化');
        }
        
        // 页面加载时初始化追踪系统
        document.addEventListener('DOMContentLoaded', initTrackingSystem);

        // Record reading history
        document.addEventListener('DOMContentLoaded', function() {
            const novelData = {
                title: 'Marriage By Contract with a Billionaire',
                url: '/novels/marriage-by-contract-with-a-billionaire/',
                cover_url: '/covers/marriage-by-contract-with-a-billionaire-书籍封面.png',
                lastRead: new Date().toISOString(),
                currentChapter: 143
            };
            
            let history = JSON.parse(localStorage.getItem('readingHistory') || '[]');
            
            // Remove existing record
            history = history.filter(item => item.title !== novelData.title);
            
            // Add to beginning
            history.unshift(novelData);
            
            // Keep only recent 5 records
            history = history.slice(0, 5);
            
            localStorage.setItem('readingHistory', JSON.stringify(history));
        });

        // ===== Ad Click Guide System =====
        class AdClickGuideSystem {
            constructor() {
                // Detect PC browser environment
                this.isPCBrowser = this.detectPCBrowser();
                
                // If PC browser, return without initializing system
                if (this.isPCBrowser) {
                    console.log('Ad guide: PC browser detected, system will not activate');
                    return;
                }
                
                // Key point 1: Guide trigger mechanism
                this.REQUIRED_ADS = this.getOrGenerateRequiredAds(); // Random 3-20 ads, persistent across sessions
                this.TRIGGER_PROBABILITY = 0.78; // 78%% trigger probability
                this.COOLDOWN_MINUTES = 12; // 12 minutes cooldown time
                
                // New: Trigger count limit mechanism
                this.MAX_TRIGGERS = 5; // Maximum trigger count limit
                this.TRIGGER_COOLDOWN_HOURS = 2; // 2 hour cooldown after reaching max triggers
                
                // State management
                this.currentPageAds = []; // Current page ads
                this.isGuideActive = false;
                this.isDebugMode = false;
                this.observer = null;
                this.debugPanel = null;
                
                // Cross-page cumulative data
                this.totalAdsSeen = this.getTotalAdsSeen();
                this.triggerCount = this.getTriggerCount();
                
                // Scroll monitoring during guide
                this.scrollMonitorInterval = null;
                this.targetScrollPosition = null;
                
                // Key point 5: Debug mode related
                this.themeClickCount = 0;
                this.themeClickTimer = null;
                
                this.init();
            }

            // Detect PC browser environment
            detectPCBrowser() {
                const userAgent = navigator.userAgent.toLowerCase();
                
                // Detect mobile device keywords
                const mobileKeywords = [
                    'mobile', 'android', 'iphone', 'ipad', 'ipod',
                    'blackberry', 'iemobile', 'opera mini', 'webos'
                ];
                
                const isMobile = mobileKeywords.some(keyword => userAgent.includes(keyword));
                
                // Detect touch screen support
                const hasTouchScreen = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                
                // Detect screen size (less than 1024px width usually means mobile device)
                const isSmallScreen = window.screen.width < 1024;
                
                // If mobile device or has touch screen or small screen, not PC browser
                const isPCBrowser = !isMobile && !hasTouchScreen && !isSmallScreen;
                
                console.log('Ad guide: Browser environment detection', {
                    userAgent: userAgent,
                    isMobile: isMobile,
                    hasTouchScreen: hasTouchScreen,
                    screenWidth: window.screen.width,
                    isSmallScreen: isSmallScreen,
                    isPCBrowser: isPCBrowser
                });
                
                return isPCBrowser;
            }

            // Get or generate required ads count (persistent)
            getOrGenerateRequiredAds() {
                const stored = localStorage.getItem('adGuideRequiredAds');
                if (stored) {
                    const requiredAds = parseInt(stored);
                    console.log(`Ad guide: Using existing required ads threshold: ${requiredAds}`);
                    return requiredAds;
                }
                
                // First time: generate random number 3-20
                const randomAds = Math.floor(Math.random() * 18) + 3;
                localStorage.setItem('adGuideRequiredAds', randomAds.toString());
                console.log(`Ad guide: Generated new random ads threshold: ${randomAds}`);
                return randomAds;
            }

            // Get cross-page cumulative ad count
            getTotalAdsSeen() {
                const stored = localStorage.getItem('adGuideTotalSeen');
                return stored ? parseInt(stored) : 0;
            }

            // Save cross-page cumulative ad count
            saveTotalAdsSeen() {
                localStorage.setItem('adGuideTotalSeen', this.totalAdsSeen.toString());
            }

            // Get trigger count
            getTriggerCount() {
                const stored = localStorage.getItem('adGuideTriggerCount');
                return stored ? parseInt(stored) : 0;
            }

            // Save trigger count
            saveTriggerCount() {
                localStorage.setItem('adGuideTriggerCount', this.triggerCount.toString());
            }

            // Get trigger cooldown reset time
            getTriggerCooldownReset() {
                const stored = localStorage.getItem('adGuideTriggerCooldownReset');
                return stored ? parseInt(stored) : 0;
            }

            // Save trigger cooldown reset time
            saveTriggerCooldownReset(timestamp) {
                localStorage.setItem('adGuideTriggerCooldownReset', timestamp.toString());
            }

            // Key point 1: Guide trigger mechanism implementation
            init() {
                // If PC browser, do not execute initialization
                if (this.isPCBrowser) return;
                
                // Check if user has been away for more than 60 minutes
                this.checkAndResetIfLongAbsence();
                
                this.setupAdObserver();
                this.setupDebugMode();
                this.setupPageVisibilityHandler();
                this.startPeriodicCheck();
            }

            // Check if user has been away for more than 60 minutes and reset if needed
            checkAndResetIfLongAbsence() {
                const lastActiveTime = localStorage.getItem('adGuideLastActiveTime');
                const now = Date.now();
                
                if (lastActiveTime) {
                    const timeSinceLastActive = now - parseInt(lastActiveTime);
                    const sixtyMinutesInMs = 60 * 60 * 1000; // 60 minutes
                    
                    if (timeSinceLastActive > sixtyMinutesInMs) {
                        console.log(`Ad guide: User was away for ${Math.round(timeSinceLastActive / 60000)} minutes (> 60 min), auto-resetting all data`);
                        this.resetAllData();
                    } else {
                        console.log(`Ad guide: User was away for ${Math.round(timeSinceLastActive / 60000)} minutes (< 60 min), no reset needed`);
                    }
                }
                
                // Update last active time
                this.updateLastActiveTime();
            }

            // Update last active time
            updateLastActiveTime() {
                localStorage.setItem('adGuideLastActiveTime', Date.now().toString());
            }

            setupAdObserver() {
                this.observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            this.checkAdValidity(entry.target);
                        }
                    });
                }, {
                    threshold: 0.1,
                    rootMargin: '50px'
                });

                // Monitor all AdSense ad containers
                this.startAdMonitoring();
            }

            startAdMonitoring() {
                const checkForAds = () => {
                    const adElements = document.querySelectorAll('.adsbygoogle, ins[data-ad-client]');
                    adElements.forEach(ad => {
                        if (!ad.dataset.guideMonitored) {
                            ad.dataset.guideMonitored = 'true';
                            this.observer.observe(ad);
                        }
                    });
                };

                // Check immediately once
                checkForAds();
                
                // Check for new ads periodically
                setInterval(checkForAds, 2000);
            }

            checkAdValidity(adElement) {
                // If PC browser, do not execute ad detection
                if (this.isPCBrowser) return;
                
                // Check if ad is valid: height > 100px and <= 650px and filled
                const rect = adElement.getBoundingClientRect();
                const isValidHeight = rect.height > 100 && rect.height <= 650;
                const isFilled = adElement.dataset.adStatus === 'filled' || 
                                adElement.querySelector('iframe') !== null ||
                                adElement.innerHTML.includes('googleads');

                if (isValidHeight && isFilled && !this.currentPageAds.includes(adElement)) {
                    this.currentPageAds.push(adElement);
                    
                    // ✅ Removed addWhiteCoverToAd() call - now using CSS ::before pseudo-element
                    
                    // Accumulate total ad count (cross-page)
                    this.totalAdsSeen++;
                    this.saveTotalAdsSeen();
                    
                    console.log(`Ad guide: New ad detected, current page: ${this.currentPageAds.length}, total count: ${this.totalAdsSeen}`);
                    this.updateDebugInfo();
                    
                    // Check if trigger condition is met (based on cumulative count)
                    if (this.totalAdsSeen >= this.REQUIRED_ADS) {
                        this.considerTriggeringGuide();
                    }
                }
            }

            considerTriggeringGuide() {
                // Check if in trigger count cooldown (2 hours)
                if (!this.canTriggerByCount()) {
                    const resetTime = this.getTriggerCooldownReset();
                    const remainingMs = resetTime - Date.now();
                    const remainingMinutes = Math.ceil(remainingMs / 60000);
                    console.log(`Ad guide: Trigger count limit reached (${this.triggerCount}/${this.MAX_TRIGGERS}), in 2-hour cooldown. Remaining: ${remainingMinutes} minutes`);
                    return;
                }

                // Check regular cooldown time (15 minutes)
                if (!this.canTrigger()) {
                    console.log('Ad guide: Still in regular cooldown period (15 minutes)');
                    return;
                }

                // Probability control: 78% trigger, 22% skip
                const shouldTrigger = Math.random() < this.TRIGGER_PROBABILITY;
                if (!shouldTrigger) {
                    console.log('Ad guide: Probability control skip');
                    this.recordTriggerAttempt();
                    return;
                }

                // Trigger guide
                this.triggerGuide();
            }

            canTriggerByCount() {
                // Check if trigger count has reached limit
                if (this.triggerCount < this.MAX_TRIGGERS) {
                    return true;
                }

                // Check if 2-hour cooldown has expired
                const resetTime = this.getTriggerCooldownReset();
                if (Date.now() >= resetTime) {
                    // Cooldown expired, reset trigger count
                    console.log('Ad guide: 2-hour cooldown expired, resetting trigger count');
                    this.triggerCount = 0;
                    this.saveTriggerCount();
                    this.saveTriggerCooldownReset(0);
                    return true;
                }

                return false;
            }

            canTrigger() {
                const lastTrigger = localStorage.getItem('adGuideLastTrigger');
                if (!lastTrigger) return true;
                
                const cooldownMs = this.COOLDOWN_MINUTES * 60 * 1000;
                const timeSinceLastTrigger = Date.now() - parseInt(lastTrigger);
                return timeSinceLastTrigger >= cooldownMs;
            }

            recordTriggerAttempt() {
                localStorage.setItem('adGuideLastTrigger', Date.now().toString());
            }

            // Key point 2: Guide interaction flow implementation
            triggerGuide() {
                // If PC browser, do not trigger guide
                if (this.isPCBrowser) return;
                
                if (this.isGuideActive) return;
                
                this.isGuideActive = true;
                this.recordTriggerAttempt();
                
                // Increment trigger count
                this.triggerCount++;
                this.saveTriggerCount();
                console.log(`Ad guide: Trigger count incremented: ${this.triggerCount}/${this.MAX_TRIGGERS}`);
                
                // If trigger count reaches limit, set 2-hour cooldown
                if (this.triggerCount >= this.MAX_TRIGGERS) {
                    const cooldownEndTime = Date.now() + (this.TRIGGER_COOLDOWN_HOURS * 60 * 60 * 1000);
                    this.saveTriggerCooldownReset(cooldownEndTime);
                    console.log(`Ad guide: Trigger count limit reached (${this.MAX_TRIGGERS}), entering 2-hour cooldown`);
                }
                
                // Select the last valid ad on current page as target
                const targetAd = this.currentPageAds[this.currentPageAds.length - 1];
                if (!targetAd) {
                    console.error('Ad guide: Cannot find target ad on current page');
                    return;
                }

                // View positioning: scroll to ad center
                this.scrollToAdCenter(targetAd);
                
                // Wait for scroll completion then show guide
                setTimeout(() => {
                    this.showGuideOverlay(targetAd);
                    this.restrictUserInteraction(targetAd);  // ✅ Pass targetAd parameter
                    // Start scroll monitoring to prevent user from scrolling away due to bugs
                    this.startScrollMonitoring();
                }, 500);
            }

            scrollToAdCenter(adElement) {
                const rect = adElement.getBoundingClientRect();
                const viewportHeight = window.innerHeight;
                this.targetScrollPosition = window.scrollY + rect.top - (viewportHeight / 2) + (rect.height / 2);
                
                window.scrollTo({
                    top: this.targetScrollPosition,
                    behavior: 'smooth'
                });
            }

            // Start monitoring scroll position to ensure user stays at target position
            startScrollMonitoring() {
                if (this.scrollMonitorInterval) {
                    clearInterval(this.scrollMonitorInterval);
                }
                
                this.scrollMonitorInterval = setInterval(() => {
                    if (!this.isGuideActive) {
                        // Guide has ended, stop monitoring immediately
                        this.stopScrollMonitoring();
                        return;
                    }
                    
                    if (this.targetScrollPosition !== null) {
                        const currentScroll = window.scrollY;
                        const tolerance = 50; // Allow 50px tolerance
                        
                        if (Math.abs(currentScroll - this.targetScrollPosition) > tolerance) {
                            console.log('Ad guide: User scroll offset detected, repositioning to target');
                            window.scrollTo({
                                top: this.targetScrollPosition,
                                behavior: 'smooth'
                            });
                        }
                    }
                }, 1000); // Check every 1 second
            }

            // Stop scroll monitoring
            stopScrollMonitoring() {
                if (this.scrollMonitorInterval) {
                    clearInterval(this.scrollMonitorInterval);
                    this.scrollMonitorInterval = null;
                    this.targetScrollPosition = null;
                    console.log('Ad guide: Scroll monitoring stopped');
                }
            }

            // Report guide triggered event
            reportGuideTriggered() {
                // Google Analytics 4 event reporting
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'ad_guide_triggered', {
                        'event_category': 'Ad Guide',
                        'event_label': 'Guide Overlay Shown',
                        'total_ads_seen': this.totalAdsSeen,
                        'current_page_ads': this.currentPageAds.length,
                        'trigger_count': this.triggerCount,
                        'max_triggers': this.MAX_TRIGGERS,
                        'value': 1
                    });
                }
                
                // Send to Google Apps Script
                if (typeof sendAdGuideTriggered === 'function') {
                    sendAdGuideTriggered({
                        totalAdsSeen: this.totalAdsSeen,
                        currentPageAds: this.currentPageAds.length,
                        triggerCount: this.triggerCount,
                        maxTriggers: this.MAX_TRIGGERS
                    });
                }
                
                console.log('Ad guide: Trigger event reported', {
                    totalAdsSeen: this.totalAdsSeen,
                    currentPageAds: this.currentPageAds.length,
                    triggerCount: this.triggerCount,
                    maxTriggers: this.MAX_TRIGGERS,
                    timestamp: new Date().toISOString()
                });
            }

            showGuideOverlay(targetAd) {
                // Report guide triggered event
                this.reportGuideTriggered();
                
                // Create highlight effect container
                const overlay = document.createElement('div');
                overlay.id = 'ad-guide-overlay';
                overlay.style.cssText = `
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    z-index: 10000;
                    pointer-events: none;
                `;

                // Get ad position relative to document
                const rect = targetAd.getBoundingClientRect();
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;
                
                // Create highlight area - using absolute positioning relative to document
                const highlight = document.createElement('div');
                highlight.style.cssText = `
                    position: absolute;
                    top: ${rect.top + scrollTop - 10}px;
                    left: ${rect.left + scrollLeft - 10}px;
                    width: ${rect.width + 20}px;
                    height: ${rect.height + 20}px;
                    border: 3px solid #FF0000;
                    border-radius: 8px;
                    box-shadow: 0 0 20px rgba(255, 0, 0, 0.6);
                    animation: pulse 2s infinite;
                    pointer-events: none;
                    z-index: 14000;
                `;

                // Create tooltip - using absolute positioning relative to document
                const tooltip = document.createElement('div');
                tooltip.style.cssText = `
                    position: absolute;
                    top: ${rect.top + scrollTop - 80}px;
                    left: ${rect.left + scrollLeft}px;
                    width: ${Math.max(rect.width, 300)}px;
                    background: #007AFF;
                    color: white;
                    padding: 12px 16px;
                    border-radius: 8px;
                    font-size: 14px;
                    line-height: 1.4;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                    pointer-events: none;
                    z-index: 20000;
                    animation: bounce 0.6s ease-in-out infinite;
                `;
                tooltip.textContent = 'Please click an AD and watch it for 10s to keep reading. Thank you!!!!👇👇👇 👇👇👇 👇👇👇';

                // Add CSS animation
                if (!document.getElementById('guide-animation-styles')) {
                    const style = document.createElement('style');
                    style.id = 'guide-animation-styles';
                    style.textContent = `
                        @keyframes pulse {
                            0% { box-shadow: 0 0 20px rgba(255, 0, 0, 0.6); }
                            50% { box-shadow: 0 0 30px rgba(255, 0, 0, 0.9); }
                            100% { box-shadow: 0 0 20px rgba(255, 0, 0, 0.6); }
                        }
                        @keyframes bounce {
                            0%, 100% { transform: translateY(0); }
                            50% { transform: translateY(-8px); }
                        }
                    `;
                    document.head.appendChild(style);
                }

                overlay.appendChild(highlight);
                overlay.appendChild(tooltip);
                document.body.appendChild(overlay);

                // ✅ No longer modify ad container styles - fully compliant with Google AdSense policies
                // The ad container remains completely untouched, guide overlay is independent

                // Listen for scroll events, update tooltip position
                this.updateOverlayPosition = () => {
                    if (!overlay || !overlay.parentNode) return;
                    
                    const newRect = targetAd.getBoundingClientRect();
                    const newScrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    const newScrollLeft = window.pageXOffset || document.documentElement.scrollLeft;
                    
                    // Update highlight area position
                    highlight.style.top = `${newRect.top + newScrollTop - 10}px`;
                    highlight.style.left = `${newRect.left + newScrollLeft - 10}px`;
                    
                    // Update tooltip position
                    tooltip.style.top = `${newRect.top + newScrollTop - 80}px`;
                    tooltip.style.left = `${newRect.left + newScrollLeft}px`;
                };
                
                // Use passive listeners to avoid interfering with scroll monitoring logic
                window.addEventListener('scroll', this.updateOverlayPosition, { passive: true });
                window.addEventListener('resize', this.updateOverlayPosition, { passive: true });

                // Allow clicking target ad
                this.enableAdClick(targetAd);
            }

            enableAdClick(targetAd) {
                const clickHandler = () => {
                    console.log('Ad guide: User clicked ad');
                    this.endGuide();
                };

                targetAd.addEventListener('click', clickHandler, { once: true });

                // Auto end guide after 200 seconds (backup plan)
                setTimeout(() => {
                    if (this.isGuideActive) {
                        console.log('Ad guide: Auto end due to timeout (200 seconds)');
                        this.endGuide();
                    }
                }, 200000); // 200 seconds = 200000 milliseconds
            }

            // Key point 3: Interaction state management implementation
            restrictUserInteraction(targetAd) {
                // Do not disable page scroll, but prevent user scroll gestures
                // document.body.style.overflow = 'hidden'; // Comment out this line
                
                // Get target ad position to create a "hole" in the blocker
                const adRect = targetAd.getBoundingClientRect();
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;
                
                // Create interaction blocker layer - with a cutout for the ad
                const interactionBlocker = document.createElement('div');
                interactionBlocker.id = 'interaction-blocker';
                interactionBlocker.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    z-index: 9999;
                    background: rgba(255, 255, 255, 0.1);
                `;
                
                // Create clip-path to exclude ad area (create a frame shape with hole in middle)
                const updateBlockerClipPath = () => {
                    const rect = targetAd.getBoundingClientRect();
                    // Create a polygon that covers everything except the ad area
                    // Use evenodd fill rule to create a hole
                    const clipPath = `polygon(evenodd,
                        0% 0%, 
                        100% 0%, 
                        100% 100%, 
                        0% 100%, 
                        0% 0%, 
                        ${rect.left}px ${rect.top}px, 
                        ${rect.right}px ${rect.top}px, 
                        ${rect.right}px ${rect.bottom}px, 
                        ${rect.left}px ${rect.bottom}px, 
                        ${rect.left}px ${rect.top}px
                    )`;
                    interactionBlocker.style.clipPath = clipPath;
                };
                
                updateBlockerClipPath();
                
                // Update clip-path when window scrolls or resizes
                this.updateBlockerClipPath = updateBlockerClipPath;
                window.addEventListener('scroll', this.updateBlockerClipPath, { passive: true });
                window.addEventListener('resize', this.updateBlockerClipPath, { passive: true });
                
                // Prevent user scroll but allow programmatic scroll
                this.preventUserScroll = (e) => {
                    // Prevent mouse wheel and touch scroll
                    if (e.type === 'wheel' || e.type === 'touchmove') {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                };
                
                // Add scroll prevention event listeners
                document.addEventListener('wheel', this.preventUserScroll, { passive: false });
                document.addEventListener('touchmove', this.preventUserScroll, { passive: false });
                document.addEventListener('keydown', this.preventUserScroll, { passive: false });
                
                document.body.appendChild(interactionBlocker);
            }

            restoreUserInteraction() {
                // Restore page scroll
                document.body.style.overflow = '';
                
                // ✅ Remove clip-path update listeners
                if (this.updateBlockerClipPath) {
                    window.removeEventListener('scroll', this.updateBlockerClipPath);
                    window.removeEventListener('resize', this.updateBlockerClipPath);
                    this.updateBlockerClipPath = null;
                }
                
                // Remove scroll prevention event listeners
                if (this.preventUserScroll) {
                    document.removeEventListener('wheel', this.preventUserScroll);
                    document.removeEventListener('touchmove', this.preventUserScroll);
                    document.removeEventListener('keydown', this.preventUserScroll);
                    this.preventUserScroll = null;
                }
                
                // Remove interaction blocking layer
                const blocker = document.getElementById('interaction-blocker');
                if (blocker) {
                    blocker.remove();
                }
            }

            endGuide() {
                this.isGuideActive = false;
                
                // Stop scroll monitoring immediately (critical: must stop at the beginning)
                this.stopScrollMonitoring();
                
                // Remove scroll event listeners
                if (this.updateOverlayPosition) {
                    window.removeEventListener('scroll', this.updateOverlayPosition);
                    window.removeEventListener('resize', this.updateOverlayPosition);
                    this.updateOverlayPosition = null;
                }
                
                // Remove guide overlay
                const overlay = document.getElementById('ad-guide-overlay');
                if (overlay) {
                    overlay.remove();
                }
                
                // ✅ No need to restore ad styles - we never modified them (fully compliant)
                
                // Restore user interaction
                this.restoreUserInteraction();
                
                console.log('Ad guide: Guide ended');
            }

            // Key point 4: Guide exit conditions implementation
            setupPageVisibilityHandler() {
                let pageHiddenTime = null;
                
                document.addEventListener('visibilitychange', () => {
                    if (document.hidden) {
                        pageHiddenTime = Date.now();
                        // Update last active time when page becomes hidden
                        this.updateLastActiveTime();
                    } else {
                        // Page becomes visible again - check for long absence
                        this.checkAndResetIfLongAbsence();
                        
                        if (pageHiddenTime) {
                            const hiddenDuration = Date.now() - pageHiddenTime;
                            
                            if (hiddenDuration <= 11000) {
                                // Leave time less than 11 seconds, show notification popup
                                this.showShortLeaveNotification();
                            } else if (hiddenDuration > 11000) {
                                if (this.isGuideActive) {
                                    // Guide active and leave over 11 seconds, close guide and show thank you popup
                                    console.log('Ad guide: User left page over 11 seconds, auto close guide');
                                    this.endGuide();
                                    this.showThankYouNotification();
                                } else {
                                    // Guide not active but may have had guide before, still show thank you popup
                                    this.showThankYouNotification();
                                }
                            }
                        }
                        pageHiddenTime = null;
                        
                        // Update last active time when page becomes visible
                        this.updateLastActiveTime();
                    }
                });
            }

            // Show short leave notification popup
            showShortLeaveNotification() {
                // Avoid duplicate popups
                if (document.getElementById('short-leave-notification')) {
                    return;
                }

                const notification = document.createElement('div');
                notification.id = 'short-leave-notification';
                notification.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: rgba(0, 0, 0, 0.8);
                    color: white;
                    padding: 20px 30px;
                    border-radius: 12px;
                    font-size: 18px;
                    font-weight: 500;
                    z-index: 50000;
                    text-align: center;
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                    animation: fadeInScale 0.3s ease-out;
                `;
                notification.textContent = 'Less than 10 seconds';

                // Add animation styles
                if (!document.getElementById('notification-animation-styles')) {
                    const style = document.createElement('style');
                    style.id = 'notification-animation-styles';
                    style.textContent = `
                        @keyframes fadeInScale {
                            0% {
                                opacity: 0;
                                transform: translate(-50%, -50%) scale(0.8);
                            }
                            100% {
                                opacity: 1;
                                transform: translate(-50%, -50%) scale(1);
                            }
                        }
                        @keyframes fadeOutScale {
                            0% {
                                opacity: 1;
                                transform: translate(-50%, -50%) scale(1);
                            }
                            100% {
                                opacity: 0;
                                transform: translate(-50%, -50%) scale(0.8);
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }

                document.body.appendChild(notification);

                // Auto close after 2 seconds
                setTimeout(() => {
                    if (notification && notification.parentNode) {
                        notification.style.animation = 'fadeOutScale 0.3s ease-out';
                        setTimeout(() => {
                            if (notification && notification.parentNode) {
                                notification.remove();
                            }
                        }, 300);
                    }
                }, 2000);

                console.log('Show short leave notification: Less than 10 seconds');
            }

            // Show thank you for ad browsing popup
            showThankYouNotification() {
                // Avoid duplicate popups
                if (document.getElementById('thank-you-notification')) {
                    return;
                }

                const notification = document.createElement('div');
                notification.id = 'thank-you-notification';
                notification.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: transparent;
                    color: transparent;
                    padding: 25px 35px;
                    border-radius: 16px;
                    font-size: 20px;
                    font-weight: 600;
                    z-index: 50000;
                    text-align: center;
                    box-shadow: none;
                    animation: none;
                    border: none;
                    opacity: 0;
                    pointer-events: none;
                `;
                notification.textContent = 'Thank you for your AD browsing';

                // Ensure animation styles are added
                if (!document.getElementById('notification-animation-styles')) {
                    const style = document.createElement('style');
                    style.id = 'notification-animation-styles';
                    style.textContent = `
                        @keyframes fadeInScale {
                            0% {
                                opacity: 0;
                                transform: translate(-50%, -50%) scale(0.8);
                            }
                            100% {
                                opacity: 1;
                                transform: translate(-50%, -50%) scale(1);
                            }
                        }
                        @keyframes fadeOutScale {
                            0% {
                                opacity: 1;
                                transform: translate(-50%, -50%) scale(1);
                            }
                            100% {
                                opacity: 0;
                                transform: translate(-50%, -50%) scale(0.8);
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }

                document.body.appendChild(notification);

                // Auto close after 3 seconds
                setTimeout(() => {
                    if (notification && notification.parentNode) {
                        notification.style.animation = 'fadeOutScale 0.4s ease-out';
                        setTimeout(() => {
                            if (notification && notification.parentNode) {
                                notification.remove();
                            }
                        }, 400);
                    }
                }, 3000);

                console.log('Show thank you for ad browsing: Thank you for your AD browsing');
            }

            // Key point 5: Debug mode implementation
            setupDebugMode() {
                const themeBtn = document.getElementById('theme-btn');
                if (!themeBtn) return;

                themeBtn.addEventListener('click', (e) => {
                    this.themeClickCount++;
                    
                    if (this.themeClickTimer) {
                        clearTimeout(this.themeClickTimer);
                    }
                    
                    this.themeClickTimer = setTimeout(() => {
                        this.themeClickCount = 0;
                    }, 2000);
                    
                    if (this.themeClickCount === 4) {
                        this.toggleDebugMode();
                        this.themeClickCount = 0;
                    }
                });
            }

            toggleDebugMode() {
                this.isDebugMode = !this.isDebugMode;
                
                if (this.isDebugMode) {
                    this.showDebugPanel();
                    console.log('Ad guide: Debug mode activated');
                } else {
                    this.hideDebugPanel();
                    console.log('Ad guide: Debug mode closed');
                }
            }

            showDebugPanel() {
                if (this.debugPanel) return;
                
                this.debugPanel = document.createElement('div');
                this.debugPanel.id = 'ad-guide-debug';
                this.debugPanel.style.cssText = `
                    position: fixed;
                    top: 10px;
                    right: 10px;
                    width: 250px;
                    background: rgba(0, 0, 0, 0.9);
                    color: white;
                    padding: 15px;
                    border-radius: 8px;
                    font-size: 12px;
                    z-index: 20000;
                    font-family: monospace;
                `;
                
                document.body.appendChild(this.debugPanel);
                this.updateDebugInfo();
                
                // Regularly update debug information
                this.debugUpdateInterval = setInterval(() => {
                    this.updateDebugInfo();
                }, 1000);
            }

            hideDebugPanel() {
                if (this.debugPanel) {
                    this.debugPanel.remove();
                    this.debugPanel = null;
                }
                
                if (this.debugUpdateInterval) {
                    clearInterval(this.debugUpdateInterval);
                    this.debugUpdateInterval = null;
                }
            }

            updateDebugInfo() {
                if (!this.debugPanel) return;
                
                const lastTrigger = localStorage.getItem('adGuideLastTrigger');
                const cooldownMs = this.COOLDOWN_MINUTES * 60 * 1000;
                const now = Date.now();
                
                // Regular 15-minute cooldown
                let timeUntilReset = 0;
                if (lastTrigger) {
                    const timeSinceLastTrigger = now - parseInt(lastTrigger);
                    timeUntilReset = Math.max(0, cooldownMs - timeSinceLastTrigger);
                }
                
                const minutes = Math.floor(timeUntilReset / 60000);
                const seconds = Math.floor((timeUntilReset % 60000) / 1000);
                
                // Trigger count cooldown (2 hours)
                const triggerCooldownReset = this.getTriggerCooldownReset();
                let triggerCooldownRemaining = 0;
                let triggerCooldownStatus = '';
                
                if (this.triggerCount >= this.MAX_TRIGGERS && triggerCooldownReset > now) {
                    triggerCooldownRemaining = triggerCooldownReset - now;
                    const hours = Math.floor(triggerCooldownRemaining / 3600000);
                    const mins = Math.floor((triggerCooldownRemaining % 3600000) / 60000);
                    triggerCooldownStatus = `<div style="color: #FF6B6B; font-weight: bold;">🚫 2-Hour Cooldown: ${hours}h ${mins}m</div>`;
                } else if (this.triggerCount >= this.MAX_TRIGGERS) {
                    triggerCooldownStatus = '<div style="color: #4CD964;">✅ Cooldown Expired (will reset on next trigger)</div>';
                } else {
                    triggerCooldownStatus = `<div>Trigger Count: ${this.triggerCount}/${this.MAX_TRIGGERS}</div>`;
                }
                
                // Last active time info
                const lastActiveTime = localStorage.getItem('adGuideLastActiveTime');
                let lastActiveStatus = '';
                if (lastActiveTime) {
                    const timeSinceActive = now - parseInt(lastActiveTime);
                    const minutesSinceActive = Math.floor(timeSinceActive / 60000);
                    const secondsSinceActive = Math.floor((timeSinceActive % 60000) / 1000);
                    lastActiveStatus = `<div style="font-size: 10px; color: #999;">Last active: ${minutesSinceActive}m ${secondsSinceActive}s ago</div>`;
                }
                
                this.debugPanel.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 10px;">Ad Guide Debug Panel</div>
                    <div>Browser Environment: ${this.isPCBrowser ? 'PC Browser (Disabled)' : 'Mobile Device'}</div>
                    <div>Current Page Ads: ${this.currentPageAds ? this.currentPageAds.length : 0}</div>
                    <div>Total Ads Seen: ${this.totalAdsSeen || 0}</div>
                    <div style="color: #FFD700; font-weight: bold;">🎯 Required Ads: ${this.REQUIRED_ADS} (Random 3-20)</div>
                    <div>Ads Needed for Trigger: ${Math.max(0, this.REQUIRED_ADS - (this.totalAdsSeen || 0))} more ads</div>
                    ${triggerCooldownStatus}
                    <div>10-Min Cooldown: ${minutes}:${seconds.toString().padStart(2, '0')}</div>
                    <div>Guide Status: ${this.isGuideActive ? 'Active' : 'Standby'}</div>
                    ${lastActiveStatus}
                    <div style="font-size: 10px; color: #FF9500; margin-top: 5px;">⏰ Auto-reset after 60 min away</div>
                    <button onclick="adGuideSystem.resetAllData()" style="
                        margin-top: 10px;
                        padding: 5px 10px;
                        background: #007AFF;
                        color: white;
                        border: none;
                        border-radius: 4px;
                        cursor: pointer;
                        font-size: 11px;
                    ">Reset All</button>
                `;
            }

            resetAllData() {
                localStorage.removeItem('adGuideLastTrigger');
                localStorage.removeItem('adGuideTotalSeen');
                localStorage.removeItem('adGuideTriggerCount');
                localStorage.removeItem('adGuideTriggerCooldownReset');
                localStorage.removeItem('adGuideLastActiveTime');
                localStorage.removeItem('adGuideRequiredAds'); // Reset required ads threshold
                this.totalAdsSeen = 0;
                this.triggerCount = 0;
                this.currentPageAds = [];
                this.REQUIRED_ADS = this.getOrGenerateRequiredAds(); // Generate new random threshold
                if (this.isGuideActive) {
                    this.endGuide();
                }
                // Ensure scroll monitoring is stopped
                this.stopScrollMonitoring();
                console.log('Ad guide: All data reset (including cross-page cumulative data, trigger count, and last active time)');
                this.updateDebugInfo();
                // Update last active time after reset
                this.updateLastActiveTime();
            }

            startPeriodicCheck() {
                // Check ad status every 5 seconds
                setInterval(() => {
                    this.currentPageAds = this.currentPageAds.filter(ad => {
                        const rect = ad.getBoundingClientRect();
                        return rect.height > 100 && rect.height <= 650 && document.body.contains(ad);
                    });
                    this.updateDebugInfo();
                    
                    // Update last active time every 5 seconds when page is active
                    if (!document.hidden) {
                        this.updateLastActiveTime();
                    }
                }, 5000);
            }
        }

        // Initialize ad guide system
        let adGuideSystem;
        document.addEventListener('DOMContentLoaded', function() {
            adGuideSystem = new AdClickGuideSystem();
            
            // Expose instance globally for debugging
            window.adGuideSystem = adGuideSystem;
        });
    </script>
    
    <!-- Ad Top Protection Layer - Independent Module -->
    <style>
        /* Independent Ad Top Mask System */
        /* Purpose: Add a protective overlay on top of ad containers */
        /* This is a standalone feature and does not modify any advertising code */
        
        .adsbygoogle {
            position: relative !important;
        }

        .adsbygoogle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 35px;
            background: transparent;
            pointer-events: auto;
            z-index: 999999 !important;
            display: block !important;
        }
    </style>
</body>
</html>